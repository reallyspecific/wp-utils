(()=>{function _e(i,t){i.split(/\s+/).forEach(e=>{t(e)})}var Tt=class{constructor(){this._events={}}on(t,e){_e(t,n=>{let r=this._events[n]||[];r.push(e),this._events[n]=r})}off(t,e){var n=arguments.length;if(n===0){this._events={};return}_e(t,r=>{if(n===1){delete this._events[r];return}let o=this._events[r];o!==void 0&&(o.splice(o.indexOf(e),1),this._events[r]=o)})}trigger(t,...e){var n=this;_e(t,r=>{let o=n._events[r];o!==void 0&&o.forEach(s=>{s.apply(n,e)})})}};function Se(i){return i.plugins={},class extends i{constructor(){super(...arguments),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,e){i.plugins[t]={name:t,fn:e}}initializePlugins(t){var e,n;let r=this,o=[];if(Array.isArray(t))t.forEach(s=>{typeof s=="string"?o.push(s):(r.plugins.settings[s.name]=s.options,o.push(s.name))});else if(t)for(e in t)t.hasOwnProperty(e)&&(r.plugins.settings[e]=t[e],o.push(e));for(;n=o.shift();)r.require(n)}loadPlugin(t){var e=this,n=e.plugins,r=i.plugins[t];if(!i.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');n.requested[t]=!0,n.loaded[t]=r.fn.apply(e,[e.plugins.settings[t]||{}]),n.names.push(t)}require(t){var e=this,n=e.plugins;if(!e.plugins.loaded.hasOwnProperty(t)){if(n.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');e.loadPlugin(t)}return n.loaded[t]}}}var Pt=i=>(i=i.filter(Boolean),i.length<2?i[0]||"":ei(i)==1?"["+i.join("")+"]":"(?:"+i.join("|")+")"),Ee=i=>{if(!ti(i))return i.join("");let t="",e=0,n=()=>{e>1&&(t+="{"+e+"}")};return i.forEach((r,o)=>{if(r===i[o-1]){e++;return}n(),t+=r,e=1}),n(),t},Oe=i=>{let t=Array.from(i);return Pt(t)},ti=i=>new Set(i).size!==i.length,pt=i=>(i+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),ei=i=>i.reduce((t,e)=>Math.max(t,ni(e)),0),ni=i=>Array.from(i).length;var Ae=i=>{if(i.length===1)return[[i]];let t=[],e=i.substring(1);return Ae(e).forEach(function(r){let o=r.slice(0);o[0]=i.charAt(0)+o[0],t.push(o),o=r.slice(0),o.unshift(i.charAt(0)),t.push(o)}),t};var ii=[[0,65535]],ri="[\u0300-\u036F\xB7\u02BE\u02BC]",Wt,tn,oi=3,Ce={},Qe={"/":"\u2044\u2215",0:"\u07C0",a:"\u2C65\u0250\u0251",aa:"\uA733",ae:"\xE6\u01FD\u01E3",ao:"\uA735",au:"\uA737",av:"\uA739\uA73B",ay:"\uA73D",b:"\u0180\u0253\u0183",c:"\uA73F\u0188\u023C\u2184",d:"\u0111\u0257\u0256\u1D05\u018C\uABB7\u0501\u0266",e:"\u025B\u01DD\u1D07\u0247",f:"\uA77C\u0192",g:"\u01E5\u0260\uA7A1\u1D79\uA77F\u0262",h:"\u0127\u2C68\u2C76\u0265",i:"\u0268\u0131",j:"\u0249\u0237",k:"\u0199\u2C6A\uA741\uA743\uA745\uA7A3",l:"\u0142\u019A\u026B\u2C61\uA749\uA747\uA781\u026D",m:"\u0271\u026F\u03FB",n:"\uA7A5\u019E\u0272\uA791\u1D0E\u043B\u0509",o:"\xF8\u01FF\u0254\u0275\uA74B\uA74D\u1D11",oe:"\u0153",oi:"\u01A3",oo:"\uA74F",ou:"\u0223",p:"\u01A5\u1D7D\uA751\uA753\uA755\u03C1",q:"\uA757\uA759\u024B",r:"\u024D\u027D\uA75B\uA7A7\uA783",s:"\xDF\u023F\uA7A9\uA785\u0282",t:"\u0167\u01AD\u0288\u2C66\uA787",th:"\xFE",tz:"\uA729",u:"\u0289",v:"\u028B\uA75F\u028C",vy:"\uA761",w:"\u2C73",y:"\u01B4\u024F\u1EFF",z:"\u01B6\u0225\u0240\u2C6C\uA763",hv:"\u0195"};for(let i in Qe){let t=Qe[i]||"";for(let e=0;e<t.length;e++){let n=t.substring(e,e+1);Ce[n]=i}}var si=new RegExp(Object.keys(Ce).join("|")+"|"+ri,"gu"),ai=i=>{Wt===void 0&&(Wt=di(i||ii))},Je=(i,t="NFKD")=>i.normalize(t),Ft=i=>Array.from(i).reduce((t,e)=>t+li(e),""),li=i=>(i=Je(i).toLowerCase().replace(si,t=>Ce[t]||""),Je(i,"NFC"));function*ci(i){for(let[t,e]of i)for(let n=t;n<=e;n++){let r=String.fromCharCode(n),o=Ft(r);o!=r.toLowerCase()&&(o.length>oi||o.length!=0&&(yield{folded:o,composed:r,code_point:n}))}}var ui=i=>{let t={},e=(n,r)=>{let o=t[n]||new Set,s=new RegExp("^"+Oe(o)+"$","iu");r.match(s)||(o.add(pt(r)),t[n]=o)};for(let n of ci(i))e(n.folded,n.folded),e(n.folded,n.composed);return t},di=i=>{let t=ui(i),e={},n=[];for(let o in t){let s=t[o];s&&(e[o]=Oe(s)),o.length>1&&n.push(pt(o))}n.sort((o,s)=>s.length-o.length);let r=Pt(n);return tn=new RegExp("^"+r,"u"),e},fi=(i,t=1)=>{let e=0;return i=i.map(n=>(Wt[n]&&(e+=n.length),Wt[n]||n)),e>=t?Ee(i):""},pi=(i,t=1)=>(t=Math.max(t,i.length-1),Pt(Ae(i).map(e=>fi(e,t)))),Ze=(i,t=!0)=>{let e=i.length>1?1:0;return Pt(i.map(n=>{let r=[],o=t?n.length():n.length()-1;for(let s=0;s<o;s++)r.push(pi(n.substrs[s]||"",e));return Ee(r)}))},hi=(i,t)=>{for(let e of t){if(e.start!=i.start||e.end!=i.end||e.substrs.join("")!==i.substrs.join(""))continue;let n=i.parts,r=s=>{for(let a of n){if(a.start===s.start&&a.substr===s.substr)return!1;if(!(s.length==1||a.length==1)&&(s.start<a.start&&s.end>a.start||a.start<s.start&&a.end>s.start))return!0}return!1};if(!(e.parts.filter(r).length>0))return!0}return!1},Ut=class i{parts;substrs;start;end;constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(t){t&&(this.parts.push(t),this.substrs.push(t.substr),this.start=Math.min(t.start,this.start),this.end=Math.max(t.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(t,e){let n=new i,r=JSON.parse(JSON.stringify(this.parts)),o=r.pop();for(let c of r)n.add(c);let s=e.substr.substring(0,t-o.start),a=s.length;return n.add({start:o.start,end:o.start+a,length:a,substr:s}),n}},en=i=>{ai(),i=Ft(i);let t="",e=[new Ut];for(let n=0;n<i.length;n++){let o=i.substring(n).match(tn),s=i.substring(n,n+1),a=o?o[0]:null,c=[],l=new Set;for(let u of e){let d=u.last();if(!d||d.length==1||d.end<=n)if(a){let h=a.length;u.add({start:n,end:n+h,length:h,substr:a}),l.add("1")}else u.add({start:n,end:n+1,length:1,substr:s}),l.add("2");else if(a){let h=u.clone(n,d),v=a.length;h.add({start:n,end:n+v,length:v,substr:a}),c.push(h)}else l.add("3")}if(c.length>0){c=c.sort((u,d)=>u.length()-d.length());for(let u of c)hi(u,e)||e.push(u);continue}if(n>0&&l.size==1&&!l.has("3")){t+=Ze(e,!1);let u=new Ut,d=e[0];d&&u.add(d.last()),e=[u]}}return t+=Ze(e,!0),t};var nn=(i,t)=>{if(i)return i[t]},rn=(i,t)=>{if(i){for(var e,n=t.split(".");(e=n.shift())&&(i=i[e]););return i}},Qt=(i,t,e)=>{var n,r;return!i||(i=i+"",t.regex==null)||(r=i.search(t.regex),r===-1)?0:(n=t.string.length/i.length,r===0&&(n+=.5),n*e)},Jt=(i,t)=>{var e=i[t];if(typeof e=="function")return e;e&&!Array.isArray(e)&&(i[t]=[e])},Nt=(i,t)=>{if(Array.isArray(i))i.forEach(t);else for(var e in i)i.hasOwnProperty(e)&&t(i[e],e)},on=(i,t)=>typeof i=="number"&&typeof t=="number"?i>t?1:i<t?-1:0:(i=Ft(i+"").toLowerCase(),t=Ft(t+"").toLowerCase(),i>t?1:t>i?-1:0);var Zt=class{items;settings;constructor(t,e){this.items=t,this.settings=e||{diacritics:!0}}tokenize(t,e,n){if(!t||!t.length)return[];let r=[],o=t.split(/\s+/);var s;return n&&(s=new RegExp("^("+Object.keys(n).map(pt).join("|")+"):(.*)$")),o.forEach(a=>{let c,l=null,u=null;s&&(c=a.match(s))&&(l=c[1],a=c[2]),a.length>0&&(this.settings.diacritics?u=en(a)||null:u=pt(a),u&&e&&(u="\\b"+u)),r.push({string:a,regex:u?new RegExp(u,"iu"):null,field:l})}),r}getScoreFunction(t,e){var n=this.prepareSearch(t,e);return this._getScoreFunction(n)}_getScoreFunction(t){let e=t.tokens,n=e.length;if(!n)return function(){return 0};let r=t.options.fields,o=t.weights,s=r.length,a=t.getAttrFn;if(!s)return function(){return 1};let c=function(){return s===1?function(l,u){let d=r[0].field;return Qt(a(u,d),l,o[d]||1)}:function(l,u){var d=0;if(l.field){let h=a(u,l.field);!l.regex&&h?d+=1/s:d+=Qt(h,l,1)}else Nt(o,(h,v)=>{d+=Qt(a(u,v),l,h)});return d/s}}();return n===1?function(l){return c(e[0],l)}:t.options.conjunction==="and"?function(l){var u,d=0;for(let h of e){if(u=c(h,l),u<=0)return 0;d+=u}return d/n}:function(l){var u=0;return Nt(e,d=>{u+=c(d,l)}),u/n}}getSortFunction(t,e){var n=this.prepareSearch(t,e);return this._getSortFunction(n)}_getSortFunction(t){var e,n=[];let r=this,o=t.options,s=!t.query&&o.sort_empty?o.sort_empty:o.sort;if(typeof s=="function")return s.bind(this);let a=function(l,u){return l==="$score"?u.score:t.getAttrFn(r.items[u.id],l)};if(s)for(let l of s)(t.query||l.field!=="$score")&&n.push(l);if(t.query){e=!0;for(let l of n)if(l.field==="$score"){e=!1;break}e&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter(l=>l.field!=="$score");return n.length?function(l,u){var d,h;for(let v of n)if(h=v.field,d=(v.direction==="desc"?-1:1)*on(a(h,l),a(h,u)),d)return d;return 0}:null}prepareSearch(t,e){let n={};var r=Object.assign({},e);if(Jt(r,"sort"),Jt(r,"sort_empty"),r.fields){Jt(r,"fields");let o=[];r.fields.forEach(s=>{typeof s=="string"&&(s={field:s,weight:1}),o.push(s),n[s.field]="weight"in s?s.weight:1}),r.fields=o}return{options:r,query:t.toLowerCase().trim(),tokens:this.tokenize(t,r.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:r.nesting?rn:nn}}search(t,e){var n=this,r,o;o=this.prepareSearch(t,e),e=o.options,t=o.query;let s=e.score||n._getScoreFunction(o);t.length?Nt(n.items,(c,l)=>{r=s(c),(e.filter===!1||r>0)&&o.items.push({score:r,id:l})}):Nt(n.items,(c,l)=>{o.items.push({score:1,id:l})});let a=n._getSortFunction(o);return a&&o.items.sort(a),o.total=o.items.length,typeof e.limit=="number"&&(o.items=o.items.slice(0,e.limit)),o}};var W=i=>typeof i>"u"||i===null?null:kt(i),kt=i=>typeof i=="boolean"?i?"1":"0":i+"",te=i=>(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),sn=(i,t)=>t>0?window.setTimeout(i,t):(i.call(null),null),an=(i,t)=>{var e;return function(n,r){var o=this;e&&(o.loading=Math.max(o.loading-1,0),clearTimeout(e)),e=setTimeout(function(){e=null,o.loadedSearches[n]=!0,i.call(o,n,r)},t)}},xe=(i,t,e)=>{var n,r=i.trigger,o={};i.trigger=function(){var s=arguments[0];if(t.indexOf(s)!==-1)o[s]=arguments;else return r.apply(i,arguments)},e.apply(i,[]),i.trigger=r;for(n of t)n in o&&r.apply(i,o[n])},ln=i=>({start:i.selectionStart||0,length:(i.selectionEnd||0)-(i.selectionStart||0)}),N=(i,t=!1)=>{i&&(i.preventDefault(),t&&i.stopPropagation())},$=(i,t,e,n)=>{i.addEventListener(t,e,n)},ht=(i,t)=>{if(!t||!t[i])return!1;var e=(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0);return e===1},ee=(i,t)=>{let e=i.getAttribute("id");return e||(i.setAttribute("id",t),t)},De=i=>i.replace(/[\\"']/g,"\\$&"),gt=(i,t)=>{t&&i.append(t)},R=(i,t)=>{if(Array.isArray(i))i.forEach(t);else for(var e in i)i.hasOwnProperty(e)&&t(i[e],e)};var tt=i=>{if(i.jquery)return i[0];if(i instanceof HTMLElement)return i;if(Ie(i)){var t=document.createElement("template");return t.innerHTML=i.trim(),t.content.firstChild}return document.querySelector(i)},Ie=i=>typeof i=="string"&&i.indexOf("<")>-1,cn=i=>i.replace(/['"\\]/g,"\\$&"),ne=(i,t)=>{var e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!1),i.dispatchEvent(e)},Mt=(i,t)=>{Object.assign(i.style,t)},G=(i,...t)=>{var e=un(t);i=dn(i),i.map(n=>{e.map(r=>{n.classList.add(r)})})},lt=(i,...t)=>{var e=un(t);i=dn(i),i.map(n=>{e.map(r=>{n.classList.remove(r)})})},un=i=>{var t=[];return R(i,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},dn=i=>(Array.isArray(i)||(i=[i]),i),ie=(i,t,e)=>{if(!(e&&!e.contains(i)))for(;i&&i.matches;){if(i.matches(t))return i;i=i.parentNode}},Te=(i,t=0)=>t>0?i[i.length-1]:i[0],fn=i=>Object.keys(i).length===0,Pe=(i,t)=>{if(!i)return-1;t=t||i.nodeName;for(var e=0;i=i.previousElementSibling;)i.matches(t)&&e++;return e},T=(i,t)=>{R(t,(e,n)=>{e==null?i.removeAttribute(n):i.setAttribute(n,""+e)})},Lt=(i,t)=>{i.parentNode&&i.parentNode.replaceChild(t,i)};var pn=(i,t)=>{if(t===null)return;if(typeof t=="string"){if(!t.length)return;t=new RegExp(t,"i")}let e=o=>{var s=o.data.match(t);if(s&&o.data.length>0){var a=document.createElement("span");a.className="highlight";var c=o.splitText(s.index);c.splitText(s[0].length);var l=c.cloneNode(!0);return a.appendChild(l),Lt(c,a),1}return 0},n=o=>{o.nodeType===1&&o.childNodes&&!/(script|style)/i.test(o.tagName)&&(o.className!=="highlight"||o.tagName!=="SPAN")&&Array.from(o.childNodes).forEach(s=>{r(s)})},r=o=>o.nodeType===3?e(o):(n(o),0);r(i)},hn=i=>{var t=i.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,function(e){var n=e.parentNode;n.replaceChild(e.firstChild,e),n.normalize()})};var gi=typeof navigator>"u"?!1:/Mac/.test(navigator.userAgent),Rt=gi?"metaKey":"ctrlKey";var Fe={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(i){return i.length>0},render:{}};function re(i,t){var e=Object.assign({},Fe,t),n=e.dataAttr,r=e.labelField,o=e.valueField,s=e.disabledField,a=e.optgroupField,c=e.optgroupLabelField,l=e.optgroupValueField,u=i.tagName.toLowerCase(),d=i.getAttribute("placeholder")||i.getAttribute("data-placeholder");if(!d&&!e.allowEmptyOption){let m=i.querySelector('option[value=""]');m&&(d=m.textContent)}var h={placeholder:d,options:[],optgroups:[],items:[],maxItems:null},v=()=>{var m,I=h.options,D={},g=1;let C=0;var P=S=>{var O=Object.assign({},S.dataset),b=n&&O[n];return typeof b=="string"&&b.length&&(O=Object.assign(O,JSON.parse(b))),O},J=(S,O)=>{var b=W(S.value);if(b!=null&&!(!b&&!e.allowEmptyOption)){if(D.hasOwnProperty(b)){if(O){var M=D[b][a];M?Array.isArray(M)?M.push(O):D[b][a]=[M,O]:D[b][a]=O}}else{var E=P(S);E[r]=E[r]||S.textContent,E[o]=E[o]||b,E[s]=E[s]||S.disabled,E[a]=E[a]||O,E.$option=S,E.$order=E.$order||++C,D[b]=E,I.push(E)}S.selected&&h.items.push(b)}},K=S=>{var O,b;b=P(S),b[c]=b[c]||S.getAttribute("label")||"",b[l]=b[l]||g++,b[s]=b[s]||S.disabled,b.$order=b.$order||++C,h.optgroups.push(b),O=b[l],R(S.children,M=>{J(M,O)})};h.maxItems=i.hasAttribute("multiple")?null:1,R(i.children,S=>{m=S.tagName.toLowerCase(),m==="optgroup"?K(S):m==="option"&&J(S)})},f=()=>{let m=i.getAttribute(n);if(m)h.options=JSON.parse(m),R(h.options,D=>{h.items.push(D[o])});else{var I=i.value.trim()||"";if(!e.allowEmptyOption&&!I.length)return;let D=I.split(e.delimiter);R(D,g=>{let C={};C[r]=g,C[o]=g,h.options.push(C)}),h.items=D}};return u==="select"?v():f(),Object.assign({},Fe,h,t)}var vn=0,rt=class extends Se(Tt){constructor(t,e){super(),this.order=0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,vn++;var n,r=tt(t);if(r.tomselect)throw new Error("Tom Select already initialized on this element");r.tomselect=this;var o=window.getComputedStyle&&window.getComputedStyle(r,null);n=o.getPropertyValue("direction");let s=re(r,e);this.settings=s,this.input=r,this.tabIndex=r.tabIndex||0,this.is_select_tag=r.tagName.toLowerCase()==="select",this.rtl=/rtl/i.test(n),this.inputId=ee(r,"tomselect-"+vn),this.isRequired=r.required,this.sifter=new Zt(this.options,{diacritics:s.diacritics}),s.mode=s.mode||(s.maxItems===1?"single":"multi"),typeof s.hideSelected!="boolean"&&(s.hideSelected=s.mode==="multi"),typeof s.hidePlaceholder!="boolean"&&(s.hidePlaceholder=s.mode!=="multi");var a=s.createFilter;typeof a!="function"&&(typeof a=="string"&&(a=new RegExp(a)),a instanceof RegExp?s.createFilter=I=>a.test(I):s.createFilter=I=>this.settings.duplicates||!this.options[I]),this.initializePlugins(s.plugins),this.setupCallbacks(),this.setupTemplates();let c=tt("<div>"),l=tt("<div>"),u=this._render("dropdown"),d=tt('<div role="listbox" tabindex="-1">'),h=this.input.getAttribute("class")||"",v=s.mode;var f;if(G(c,s.wrapperClass,h,v),G(l,s.controlClass),gt(c,l),G(u,s.dropdownClass,v),s.copyClassesToDropdown&&G(u,h),G(d,s.dropdownContentClass),gt(u,d),tt(s.dropdownParent||c).appendChild(u),Ie(s.controlInput)){f=tt(s.controlInput);var m=["autocorrect","autocapitalize","autocomplete","spellcheck"];R(m,I=>{r.getAttribute(I)&&T(f,{[I]:r.getAttribute(I)})}),f.tabIndex=-1,l.appendChild(f),this.focus_node=f}else s.controlInput?(f=tt(s.controlInput),this.focus_node=f):(f=tt("<input/>"),this.focus_node=l);this.wrapper=c,this.dropdown=u,this.dropdown_content=d,this.control=l,this.control_input=f,this.setup()}setup(){let t=this,e=t.settings,n=t.control_input,r=t.dropdown,o=t.dropdown_content,s=t.wrapper,a=t.control,c=t.input,l=t.focus_node,u={passive:!0},d=t.inputId+"-ts-dropdown";T(o,{id:d}),T(l,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":d});let h=ee(l,t.inputId+"-ts-control"),v="label[for='"+cn(t.inputId)+"']",f=document.querySelector(v),m=t.focus.bind(t);if(f){$(f,"click",m),T(f,{for:h});let g=ee(f,t.inputId+"-ts-label");T(l,{"aria-labelledby":g}),T(o,{"aria-labelledby":g})}if(s.style.width=c.style.width,t.plugins.names.length){let g="plugin-"+t.plugins.names.join(" plugin-");G([s,r],g)}(e.maxItems===null||e.maxItems>1)&&t.is_select_tag&&T(c,{multiple:"multiple"}),e.placeholder&&T(n,{placeholder:e.placeholder}),!e.splitOn&&e.delimiter&&(e.splitOn=new RegExp("\\s*"+pt(e.delimiter)+"+\\s*")),e.load&&e.loadThrottle&&(e.load=an(e.load,e.loadThrottle)),$(r,"mousemove",()=>{t.ignoreHover=!1}),$(r,"mouseenter",g=>{var C=ie(g.target,"[data-selectable]",r);C&&t.onOptionHover(g,C)},{capture:!0}),$(r,"click",g=>{let C=ie(g.target,"[data-selectable]");C&&(t.onOptionSelect(g,C),N(g,!0))}),$(a,"click",g=>{var C=ie(g.target,"[data-ts-item]",a);if(C&&t.onItemSelect(g,C)){N(g,!0);return}n.value==""&&(t.onClick(),N(g,!0))}),$(l,"keydown",g=>t.onKeyDown(g)),$(n,"keypress",g=>t.onKeyPress(g)),$(n,"input",g=>t.onInput(g)),$(l,"blur",g=>t.onBlur(g)),$(l,"focus",g=>t.onFocus(g)),$(n,"paste",g=>t.onPaste(g));let I=g=>{let C=g.composedPath()[0];if(!s.contains(C)&&!r.contains(C)){t.isFocused&&t.blur(),t.inputState();return}C==n&&t.isOpen?g.stopPropagation():N(g,!0)},D=()=>{t.isOpen&&t.positionDropdown()};$(document,"mousedown",I),$(window,"scroll",D,u),$(window,"resize",D,u),this._destroy=()=>{document.removeEventListener("mousedown",I),window.removeEventListener("scroll",D),window.removeEventListener("resize",D),f&&f.removeEventListener("click",m)},this.revertSettings={innerHTML:c.innerHTML,tabIndex:c.tabIndex},c.tabIndex=-1,c.insertAdjacentElement("afterend",t.wrapper),t.sync(!1),e.items=[],delete e.optgroups,delete e.options,$(c,"invalid",()=>{t.isValid&&(t.isValid=!1,t.isInvalid=!0,t.refreshState())}),t.updateOriginalInput(),t.refreshItems(),t.close(!1),t.inputState(),t.isSetup=!0,c.disabled?t.disable():c.readOnly?t.setReadOnly(!0):t.enable(),t.on("change",this.onChange),G(c,"tomselected","ts-hidden-accessible"),t.trigger("initialize"),e.preload===!0&&t.preload()}setupOptions(t=[],e=[]){this.addOptions(t),R(e,n=>{this.registerOptionGroup(n)})}setupTemplates(){var t=this,e=t.settings.labelField,n=t.settings.optgroupLabelField,r={optgroup:o=>{let s=document.createElement("div");return s.className="optgroup",s.appendChild(o.options),s},optgroup_header:(o,s)=>'<div class="optgroup-header">'+s(o[n])+"</div>",option:(o,s)=>"<div>"+s(o[e])+"</div>",item:(o,s)=>"<div>"+s(o[e])+"</div>",option_create:(o,s)=>'<div class="create">Add <strong>'+s(o.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};t.settings.render=Object.assign({},r,t.settings.render)}setupCallbacks(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)e=this.settings[n[t]],e&&this.on(t,e)}sync(t=!0){let e=this,n=t?re(e.input,{delimiter:e.settings.delimiter}):e.settings;e.setupOptions(n.options,n.optgroups),e.setValue(n.items||[],!0),e.lastQuery=null}onClick(){var t=this;if(t.activeItems.length>0){t.clearActiveItems(),t.focus();return}t.isFocused&&t.isOpen?t.blur():t.focus()}onMouseDown(){}onChange(){ne(this.input,"input"),ne(this.input,"change")}onPaste(t){var e=this;if(e.isInputHidden||e.isLocked){N(t);return}e.settings.splitOn&&setTimeout(()=>{var n=e.inputValue();if(n.match(e.settings.splitOn)){var r=n.trim().split(e.settings.splitOn);R(r,o=>{W(o)&&(this.options[o]?e.addItem(o):e.createItem(o))})}},0)}onKeyPress(t){var e=this;if(e.isLocked){N(t);return}var n=String.fromCharCode(t.keyCode||t.which);if(e.settings.create&&e.settings.mode==="multi"&&n===e.settings.delimiter){e.createItem(),N(t);return}}onKeyDown(t){var e=this;if(e.ignoreHover=!0,e.isLocked){t.keyCode!==9&&N(t);return}switch(t.keyCode){case 65:if(ht(Rt,t)&&e.control_input.value==""){N(t),e.selectAll();return}break;case 27:e.isOpen&&(N(t,!0),e.close()),e.clearActiveItems();return;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.activeOption){let n=e.getAdjacent(e.activeOption,1);n&&e.setActiveOption(n)}N(t);return;case 38:if(e.activeOption){let n=e.getAdjacent(e.activeOption,-1);n&&e.setActiveOption(n)}N(t);return;case 13:e.canSelect(e.activeOption)?(e.onOptionSelect(t,e.activeOption),N(t)):e.settings.create&&e.createItem()?N(t):document.activeElement==e.control_input&&e.isOpen&&N(t);return;case 37:e.advanceSelection(-1,t);return;case 39:e.advanceSelection(1,t);return;case 9:e.settings.selectOnTab&&(e.canSelect(e.activeOption)&&(e.onOptionSelect(t,e.activeOption),N(t)),e.settings.create&&e.createItem()&&N(t));return;case 8:case 46:e.deleteSelection(t);return}e.isInputHidden&&!ht(Rt,t)&&N(t)}onInput(t){if(this.isLocked)return;let e=this.inputValue();if(this.lastValue!==e){if(this.lastValue=e,e==""){this._onInput();return}this.refreshTimeout&&window.clearTimeout(this.refreshTimeout),this.refreshTimeout=sn(()=>{this.refreshTimeout=null,this._onInput()},this.settings.refreshThrottle)}}_onInput(){let t=this.lastValue;this.settings.shouldLoad.call(this,t)&&this.load(t),this.refreshOptions(),this.trigger("type",t)}onOptionHover(t,e){this.ignoreHover||this.setActiveOption(e,!1)}onFocus(t){var e=this,n=e.isFocused;if(e.isDisabled||e.isReadOnly){e.blur(),N(t);return}e.ignoreFocus||(e.isFocused=!0,e.settings.preload==="focus"&&e.preload(),n||e.trigger("focus"),e.activeItems.length||(e.inputState(),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())}onBlur(t){if(document.hasFocus()!==!1){var e=this;if(e.isFocused){e.isFocused=!1,e.ignoreFocus=!1;var n=()=>{e.close(),e.setActiveItem(),e.setCaret(e.items.length),e.trigger("blur")};e.settings.create&&e.settings.createOnBlur?e.createItem(null,n):n()}}}onOptionSelect(t,e){var n,r=this;e.parentElement&&e.parentElement.matches("[data-disabled]")||(e.classList.contains("create")?r.createItem(null,()=>{r.settings.closeAfterSelect&&r.close()}):(n=e.dataset.value,typeof n<"u"&&(r.lastQuery=null,r.addItem(n),r.settings.closeAfterSelect&&r.close(),!r.settings.hideSelected&&t.type&&/click/.test(t.type)&&r.setActiveOption(e))))}canSelect(t){return!!(this.isOpen&&t&&this.dropdown_content.contains(t))}onItemSelect(t,e){var n=this;return!n.isLocked&&n.settings.mode==="multi"?(N(t),n.setActiveItem(e,t),!0):!1}canLoad(t){return!(!this.settings.load||this.loadedSearches.hasOwnProperty(t))}load(t){let e=this;if(!e.canLoad(t))return;G(e.wrapper,e.settings.loadingClass),e.loading++;let n=e.loadCallback.bind(e);e.settings.load.call(e,t,n)}loadCallback(t,e){let n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(t,e),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||lt(n.wrapper,n.settings.loadingClass),n.trigger("load",t,e)}preload(){var t=this.wrapper.classList;t.contains("preloaded")||(t.add("preloaded"),this.load(""))}setTextboxValue(t=""){var e=this.control_input,n=e.value!==t;n&&(e.value=t,ne(e,"update"),this.lastValue=t)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(t,e){var n=e?[]:["change"];xe(this,n,()=>{this.clear(e),this.addItems(t,e)})}setMaxItems(t){t===0&&(t=null),this.settings.maxItems=t,this.refreshState()}setActiveItem(t,e){var n=this,r,o,s,a,c,l;if(n.settings.mode!=="single"){if(!t){n.clearActiveItems(),n.isFocused&&n.inputState();return}if(r=e&&e.type.toLowerCase(),r==="click"&&ht("shiftKey",e)&&n.activeItems.length){for(l=n.getLastActive(),s=Array.prototype.indexOf.call(n.control.children,l),a=Array.prototype.indexOf.call(n.control.children,t),s>a&&(c=s,s=a,a=c),o=s;o<=a;o++)t=n.control.children[o],n.activeItems.indexOf(t)===-1&&n.setActiveItemClass(t);N(e)}else r==="click"&&ht(Rt,e)||r==="keydown"&&ht("shiftKey",e)?t.classList.contains("active")?n.removeActiveItem(t):n.setActiveItemClass(t):(n.clearActiveItems(),n.setActiveItemClass(t));n.inputState(),n.isFocused||n.focus()}}setActiveItemClass(t){let e=this,n=e.control.querySelector(".last-active");n&&lt(n,"last-active"),G(t,"active last-active"),e.trigger("item_select",t),e.activeItems.indexOf(t)==-1&&e.activeItems.push(t)}removeActiveItem(t){var e=this.activeItems.indexOf(t);this.activeItems.splice(e,1),lt(t,"active")}clearActiveItems(){lt(this.activeItems,"active"),this.activeItems=[]}setActiveOption(t,e=!0){t!==this.activeOption&&(this.clearActiveOption(),t&&(this.activeOption=t,T(this.focus_node,{"aria-activedescendant":t.getAttribute("id")}),T(t,{"aria-selected":"true"}),G(t,"active"),e&&this.scrollToOption(t)))}scrollToOption(t,e){if(!t)return;let n=this.dropdown_content,r=n.clientHeight,o=n.scrollTop||0,s=t.offsetHeight,a=t.getBoundingClientRect().top-n.getBoundingClientRect().top+o;a+s>r+o?this.scroll(a-r+s,e):a<o&&this.scroll(a,e)}scroll(t,e){let n=this.dropdown_content;e&&(n.style.scrollBehavior=e),n.scrollTop=t,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(lt(this.activeOption,"active"),T(this.activeOption,{"aria-selected":null})),this.activeOption=null,T(this.focus_node,{"aria-activedescendant":null})}selectAll(){let t=this;if(t.settings.mode==="single")return;let e=t.controlChildren();e.length&&(t.inputState(),t.close(),t.activeItems=e,R(e,n=>{t.setActiveItemClass(n)}))}inputState(){var t=this;t.control.contains(t.control_input)&&(T(t.control_input,{placeholder:t.settings.placeholder}),t.activeItems.length>0||!t.isFocused&&t.settings.hidePlaceholder&&t.items.length>0?(t.setTextboxValue(),t.isInputHidden=!0):(t.settings.hidePlaceholder&&t.items.length>0&&T(t.control_input,{placeholder:""}),t.isInputHidden=!1),t.wrapper.classList.toggle("input-hidden",t.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var t=this;t.isDisabled||t.isReadOnly||(t.ignoreFocus=!0,t.control_input.offsetWidth?t.control_input.focus():t.focus_node.focus(),setTimeout(()=>{t.ignoreFocus=!1,t.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())}getSearchOptions(){var t=this.settings,e=t.sortField;return typeof t.sortField=="string"&&(e=[{field:t.sortField}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}}search(t){var e,n,r=this,o=this.getSearchOptions();if(r.settings.score&&(n=r.settings.score.call(r,t),typeof n!="function"))throw new Error('Tom Select "score" setting must be a function that returns a function');return t!==r.lastQuery?(r.lastQuery=t,e=r.sifter.search(t,Object.assign(o,{score:n})),r.currentResults=e):e=Object.assign({},r.currentResults),r.settings.hideSelected&&(e.items=e.items.filter(s=>{let a=W(s.id);return!(a&&r.items.indexOf(a)!==-1)})),e}refreshOptions(t=!0){var e,n,r,o,s,a,c,l,u,d;let h={},v=[];var f=this,m=f.inputValue();let I=m===f.lastQuery||m==""&&f.lastQuery==null;var D=f.search(m),g=null,C=f.settings.shouldOpen||!1,P=f.dropdown_content;I&&(g=f.activeOption,g&&(u=g.closest("[data-group]"))),o=D.items.length,typeof f.settings.maxOptions=="number"&&(o=Math.min(o,f.settings.maxOptions)),o>0&&(C=!0);let J=(S,O)=>{let b=h[S];if(b!==void 0){let E=v[b];if(E!==void 0)return[b,E.fragment]}let M=document.createDocumentFragment();return b=v.length,v.push({fragment:M,order:O,optgroup:S}),[b,M]};for(e=0;e<o;e++){let S=D.items[e];if(!S)continue;let O=S.id,b=f.options[O];if(b===void 0)continue;let M=kt(O),E=f.getOption(M,!0);for(f.settings.hideSelected||E.classList.toggle("selected",f.items.includes(M)),s=b[f.settings.optgroupField]||"",a=Array.isArray(s)?s:[s],n=0,r=a&&a.length;n<r;n++){s=a[n];let it=b.$order,j=f.optgroups[s];j===void 0?s="":it=j.$order;let[at,yt]=J(s,it);n>0&&(E=E.cloneNode(!0),T(E,{id:b.$id+"-clone-"+n,"aria-selected":null}),E.classList.add("ts-cloned"),lt(E,"active"),f.activeOption&&f.activeOption.dataset.value==O&&u&&u.dataset.group===s.toString()&&(g=E)),yt.appendChild(E),s!=""&&(h[s]=at)}}f.settings.lockOptgroupOrder&&v.sort((S,O)=>S.order-O.order),c=document.createDocumentFragment(),R(v,S=>{let O=S.fragment,b=S.optgroup;if(!O||!O.children.length)return;let M=f.optgroups[b];if(M!==void 0){let E=document.createDocumentFragment(),it=f.render("optgroup_header",M);gt(E,it),gt(E,O);let j=f.render("optgroup",{group:M,options:E});gt(c,j)}else gt(c,O)}),P.innerHTML="",gt(P,c),f.settings.highlight&&(hn(P),D.query.length&&D.tokens.length&&R(D.tokens,S=>{pn(P,S.regex)}));var K=S=>{let O=f.render(S,{input:m});return O&&(C=!0,P.insertBefore(O,P.firstChild)),O};if(f.loading?K("loading"):f.settings.shouldLoad.call(f,m)?D.items.length===0&&K("no_results"):K("not_loading"),l=f.canCreate(m),l&&(d=K("option_create")),f.hasOptions=D.items.length>0||l,C){if(D.items.length>0){if(!g&&f.settings.mode==="single"&&f.items[0]!=null&&(g=f.getOption(f.items[0])),!P.contains(g)){let S=0;d&&!f.settings.addPrecedence&&(S=1),g=f.selectable()[S]}}else d&&(g=d);t&&!f.isOpen&&(f.open(),f.scrollToOption(g,"auto")),f.setActiveOption(g)}else f.clearActiveOption(),t&&f.isOpen&&f.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(t,e=!1){let n=this;if(Array.isArray(t))return n.addOptions(t,e),!1;let r=W(t[n.settings.valueField]);return r===null||n.options.hasOwnProperty(r)?!1:(t.$order=t.$order||++n.order,t.$id=n.inputId+"-opt-"+t.$order,n.options[r]=t,n.lastQuery=null,e&&(n.userOptions[r]=e,n.trigger("option_add",r,t)),r)}addOptions(t,e=!1){R(t,n=>{this.addOption(n,e)})}registerOption(t){return this.addOption(t)}registerOptionGroup(t){var e=W(t[this.settings.optgroupValueField]);return e===null?!1:(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)}addOptionGroup(t,e){var n;e[this.settings.optgroupValueField]=t,(n=this.registerOptionGroup(e))&&this.trigger("optgroup_add",n,e)}removeOptionGroup(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.clearCache(),this.trigger("optgroup_remove",t))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(t,e){let n=this;var r,o;let s=W(t),a=W(e[n.settings.valueField]);if(s===null)return;let c=n.options[s];if(c==null)return;if(typeof a!="string")throw new Error("Value must be set in option data");let l=n.getOption(s),u=n.getItem(s);if(e.$order=e.$order||c.$order,delete n.options[s],n.uncacheValue(a),n.options[a]=e,l){if(n.dropdown_content.contains(l)){let d=n._render("option",e);Lt(l,d),n.activeOption===l&&n.setActiveOption(d)}l.remove()}u&&(o=n.items.indexOf(s),o!==-1&&n.items.splice(o,1,a),r=n._render("item",e),u.classList.contains("active")&&G(r,"active"),Lt(u,r)),n.lastQuery=null}removeOption(t,e){let n=this;t=kt(t),n.uncacheValue(t),delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)}clearOptions(t){let e=(t||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();let n={};R(this.options,(r,o)=>{e(r,o)&&(n[o]=r)}),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(t,e){return this.items.indexOf(e)>=0}getOption(t,e=!1){let n=W(t);if(n===null)return null;let r=this.options[n];if(r!=null){if(r.$div)return r.$div;if(e)return this._render("option",r)}return null}getAdjacent(t,e,n="option"){var r=this,o;if(!t)return null;n=="item"?o=r.controlChildren():o=r.dropdown_content.querySelectorAll("[data-selectable]");for(let s=0;s<o.length;s++)if(o[s]==t)return e>0?o[s+1]:o[s-1];return null}getItem(t){if(typeof t=="object")return t;var e=W(t);return e!==null?this.control.querySelector(`[data-value="${De(e)}"]`):null}addItems(t,e){var n=this,r=Array.isArray(t)?t:[t];r=r.filter(s=>n.items.indexOf(s)===-1);let o=r[r.length-1];r.forEach(s=>{n.isPending=s!==o,n.addItem(s,e)})}addItem(t,e){var n=e?[]:["change","dropdown_close"];xe(this,n,()=>{var r,o;let s=this,a=s.settings.mode,c=W(t);if(!(c&&s.items.indexOf(c)!==-1&&(a==="single"&&s.close(),a==="single"||!s.settings.duplicates))&&!(c===null||!s.options.hasOwnProperty(c))&&(a==="single"&&s.clear(e),!(a==="multi"&&s.isFull()))){if(r=s._render("item",s.options[c]),s.control.contains(r)&&(r=r.cloneNode(!0)),o=s.isFull(),s.items.splice(s.caretPos,0,c),s.insertAtCaret(r),s.isSetup){if(!s.isPending&&s.settings.hideSelected){let l=s.getOption(c),u=s.getAdjacent(l,1);u&&s.setActiveOption(u)}!s.isPending&&!s.settings.closeAfterSelect&&s.refreshOptions(s.isFocused&&a!=="single"),s.settings.closeAfterSelect!=!1&&s.isFull()?s.close():s.isPending||s.positionDropdown(),s.trigger("item_add",c,r),s.isPending||s.updateOriginalInput({silent:e})}(!s.isPending||!o&&s.isFull())&&(s.inputState(),s.refreshState())}})}removeItem(t=null,e){let n=this;if(t=n.getItem(t),!t)return;var r,o;let s=t.dataset.value;r=Pe(t),t.remove(),t.classList.contains("active")&&(o=n.activeItems.indexOf(t),n.activeItems.splice(o,1),lt(t,"active")),n.items.splice(r,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(s)&&n.removeOption(s,e),r<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:e}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",s,t)}createItem(t=null,e=()=>{}){arguments.length===3&&(e=arguments[2]),typeof e!="function"&&(e=()=>{});var n=this,r=n.caretPos,o;if(t=t||n.inputValue(),!n.canCreate(t))return e(),!1;n.lock();var s=!1,a=c=>{if(n.unlock(),!c||typeof c!="object")return e();var l=W(c[n.settings.valueField]);if(typeof l!="string")return e();n.setTextboxValue(),n.addOption(c,!0),n.setCaret(r),n.addItem(l),e(c),s=!0};return typeof n.settings.create=="function"?o=n.settings.create.call(this,t,a):o={[n.settings.labelField]:t,[n.settings.valueField]:t},s||a(o),!0}refreshItems(){var t=this;t.lastQuery=null,t.isSetup&&t.addItems(t.items),t.updateOriginalInput(),t.refreshState()}refreshState(){let t=this;t.refreshValidityState();let e=t.isFull(),n=t.isLocked;t.wrapper.classList.toggle("rtl",t.rtl);let r=t.wrapper.classList;r.toggle("focus",t.isFocused),r.toggle("disabled",t.isDisabled),r.toggle("readonly",t.isReadOnly),r.toggle("required",t.isRequired),r.toggle("invalid",!t.isValid),r.toggle("locked",n),r.toggle("full",e),r.toggle("input-active",t.isFocused&&!t.isInputHidden),r.toggle("dropdown-active",t.isOpen),r.toggle("has-options",fn(t.options)),r.toggle("has-items",t.items.length>0)}refreshValidityState(){var t=this;t.input.validity&&(t.isValid=t.input.validity.valid,t.isInvalid=!t.isValid)}isFull(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems}updateOriginalInput(t={}){let e=this;var n,r;let o=e.input.querySelector('option[value=""]');if(e.is_select_tag){let c=function(l,u,d){return l||(l=tt('<option value="'+te(u)+'">'+te(d)+"</option>")),l!=o&&e.input.append(l),s.push(l),(l!=o||a>0)&&(l.selected=!0),l},s=[],a=e.input.querySelectorAll("option:checked").length;e.input.querySelectorAll("option:checked").forEach(l=>{l.selected=!1}),e.items.length==0&&e.settings.mode=="single"?c(o,"",""):e.items.forEach(l=>{if(n=e.options[l],r=n[e.settings.labelField]||"",s.includes(n.$option)){let u=e.input.querySelector(`option[value="${De(l)}"]:not(:checked)`);c(u,l,r)}else n.$option=c(n.$option,l,r)})}else e.input.value=e.getValue();e.isSetup&&(t.silent||e.trigger("change",e.getValue()))}open(){var t=this;t.isLocked||t.isOpen||t.settings.mode==="multi"&&t.isFull()||(t.isOpen=!0,T(t.focus_node,{"aria-expanded":"true"}),t.refreshState(),Mt(t.dropdown,{visibility:"hidden",display:"block"}),t.positionDropdown(),Mt(t.dropdown,{visibility:"visible",display:"block"}),t.focus(),t.trigger("dropdown_open",t.dropdown))}close(t=!0){var e=this,n=e.isOpen;t&&(e.setTextboxValue(),e.settings.mode==="single"&&e.items.length&&e.inputState()),e.isOpen=!1,T(e.focus_node,{"aria-expanded":"false"}),Mt(e.dropdown,{display:"none"}),e.settings.hideSelected&&e.clearActiveOption(),e.refreshState(),n&&e.trigger("dropdown_close",e.dropdown)}positionDropdown(){if(this.settings.dropdownParent==="body"){var t=this.control,e=t.getBoundingClientRect(),n=t.offsetHeight+e.top+window.scrollY,r=e.left+window.scrollX;Mt(this.dropdown,{width:e.width+"px",top:n+"px",left:r+"px"})}}clear(t){var e=this;if(e.items.length){var n=e.controlChildren();R(n,r=>{e.removeItem(r,!0)}),e.inputState(),t||e.updateOriginalInput(),e.trigger("clear")}}insertAtCaret(t){let e=this,n=e.caretPos,r=e.control;r.insertBefore(t,r.children[n]||null),e.setCaret(n+1)}deleteSelection(t){var e,n,r,o,s=this;e=t&&t.keyCode===8?-1:1,n=ln(s.control_input);let a=[];if(s.activeItems.length)o=Te(s.activeItems,e),r=Pe(o),e>0&&r++,R(s.activeItems,c=>a.push(c));else if((s.isFocused||s.settings.mode==="single")&&s.items.length){let c=s.controlChildren(),l;e<0&&n.start===0&&n.length===0?l=c[s.caretPos-1]:e>0&&n.start===s.inputValue().length&&(l=c[s.caretPos]),l!==void 0&&a.push(l)}if(!s.shouldDelete(a,t))return!1;for(N(t,!0),typeof r<"u"&&s.setCaret(r);a.length;)s.removeItem(a.pop());return s.inputState(),s.positionDropdown(),s.refreshOptions(!1),!0}shouldDelete(t,e){let n=t.map(r=>r.dataset.value);return!(!n.length||typeof this.settings.onDelete=="function"&&this.settings.onDelete(n,e)===!1)}advanceSelection(t,e){var n,r,o=this;o.rtl&&(t*=-1),!o.inputValue().length&&(ht(Rt,e)||ht("shiftKey",e)?(n=o.getLastActive(t),n?n.classList.contains("active")?r=o.getAdjacent(n,t,"item"):r=n:t>0?r=o.control_input.nextElementSibling:r=o.control_input.previousElementSibling,r&&(r.classList.contains("active")&&o.removeActiveItem(n),o.setActiveItemClass(r))):o.moveCaret(t))}moveCaret(t){}getLastActive(t){let e=this.control.querySelector(".last-active");if(e)return e;var n=this.control.querySelectorAll(".active");if(n)return Te(n,t)}setCaret(t){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(t=this.isReadOnly||this.isDisabled){this.isLocked=t,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(t){this.focus_node.tabIndex=t?-1:this.tabIndex,this.isDisabled=t,this.input.disabled=t,this.control_input.disabled=t,this.setLocked()}setReadOnly(t){this.isReadOnly=t,this.input.readOnly=t,this.control_input.readOnly=t,this.setLocked()}destroy(){var t=this,e=t.revertSettings;t.trigger("destroy"),t.off(),t.wrapper.remove(),t.dropdown.remove(),t.input.innerHTML=e.innerHTML,t.input.tabIndex=e.tabIndex,lt(t.input,"tomselected","ts-hidden-accessible"),t._destroy(),delete t.input.tomselect}render(t,e){var n,r;let o=this;if(typeof this.settings.render[t]!="function"||(r=o.settings.render[t].call(this,e,te),!r))return null;if(r=tt(r),t==="option"||t==="option_create"?e[o.settings.disabledField]?T(r,{"aria-disabled":"true"}):T(r,{"data-selectable":""}):t==="optgroup"&&(n=e.group[o.settings.optgroupValueField],T(r,{"data-group":n}),e.group[o.settings.disabledField]&&T(r,{"data-disabled":""})),t==="option"||t==="item"){let s=kt(e[o.settings.valueField]);T(r,{"data-value":s}),t==="item"?(G(r,o.settings.itemClass),T(r,{"data-ts-item":""})):(G(r,o.settings.optionClass),T(r,{role:"option",id:e.$id}),e.$div=r,o.options[s]=e)}return r}_render(t,e){let n=this.render(t,e);if(n==null)throw"HTMLElement expected";return n}clearCache(){R(this.options,t=>{t.$div&&(t.$div.remove(),delete t.$div)})}uncacheValue(t){let e=this.getOption(t);e&&e.remove()}canCreate(t){return this.settings.create&&t.length>0&&this.settings.createFilter.call(this,t)}hook(t,e,n){var r=this,o=r[e];r[e]=function(){var s,a;return t==="after"&&(s=o.apply(r,arguments)),a=n.apply(r,arguments),t==="instead"?a:(t==="before"&&(s=o.apply(r,arguments)),s)}}};var Ai=(i,t)=>{if(Array.isArray(i))i.forEach(t);else for(var e in i)i.hasOwnProperty(e)&&t(i[e],e)},Ci=(i,...t)=>{var e=xi(t);i=Di(i),i.map(n=>{e.map(r=>{n.classList.remove(r)})})},xi=i=>{var t=[];return Ai(i,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},Di=i=>(Array.isArray(i)||(i=[i]),i),Ii=(i,t)=>{if(!i)return-1;t=t||i.nodeName;for(var e=0;i=i.previousElementSibling;)i.matches(t)&&e++;return e};function bn(){var i=this;i.hook("instead","setCaret",t=>{i.settings.mode==="single"||!i.control.contains(i.control_input)?t=i.items.length:(t=Math.max(0,Math.min(i.items.length,t)),t!=i.caretPos&&!i.isPending&&i.controlChildren().forEach((e,n)=>{n<t?i.control_input.insertAdjacentElement("beforebegin",e):i.control.appendChild(e)})),i.caretPos=t}),i.hook("instead","moveCaret",t=>{if(!i.isFocused)return;let e=i.getLastActive(t);if(e){let n=Ii(e);i.setCaret(t>0?n+1:n),i.setActiveItem(),Ci(e,"last-active")}else i.setCaret(i.caretPos+t)})}var Ti=(i,t=!1)=>{i&&(i.preventDefault(),t&&i.stopPropagation())},Pi=(i,t,e,n)=>{i.addEventListener(t,e,n)},Fi=(i,t)=>{if(Array.isArray(i))i.forEach(t);else for(var e in i)i.hasOwnProperty(e)&&t(i[e],e)},yn=i=>{if(i.jquery)return i[0];if(i instanceof HTMLElement)return i;if(Ni(i)){var t=document.createElement("template");return t.innerHTML=i.trim(),t.content.firstChild}return document.querySelector(i)},Ni=i=>typeof i=="string"&&i.indexOf("<")>-1,ki=(i,...t)=>{var e=Mi(t);i=Li(i),i.map(n=>{e.map(r=>{n.classList.add(r)})})},Mi=i=>{var t=[];return Fi(i,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},Li=i=>(Array.isArray(i)||(i=[i]),i);function wn(){let i=this;i.settings.shouldOpen=!0,i.hook("before","setup",()=>{i.focus_node=i.control,ki(i.control_input,"dropdown-input");let t=yn('<div class="dropdown-input-wrap">');t.append(i.control_input),i.dropdown.insertBefore(t,i.dropdown.firstChild);let e=yn('<input class="items-placeholder" tabindex="-1" />');e.placeholder=i.settings.placeholder||"",i.control.append(e)}),i.on("initialize",()=>{i.control_input.addEventListener("keydown",e=>{switch(e.keyCode){case 27:i.isOpen&&(Ti(e,!0),i.close()),i.clearActiveItems();return;case 9:i.focus_node.tabIndex=-1;break}return i.onKeyDown.call(i,e)}),i.on("blur",()=>{i.focus_node.tabIndex=i.isDisabled?-1:i.tabIndex}),i.on("dropdown_open",()=>{i.control_input.focus()});let t=i.onBlur;i.hook("instead","onBlur",e=>{if(!(e&&e.relatedTarget==i.control_input))return t.call(i)}),Pi(i.control_input,"blur",()=>i.onBlur()),i.hook("before","close",()=>{i.isOpen&&i.focus_node.focus({preventScroll:!0})})})}function _n(){var i=this,t=i.deleteSelection;this.hook("instead","deleteSelection",e=>i.activeItems.length?t.call(i,e):!1)}var Ri=i=>(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),Sn=(i,t=!1)=>{i&&(i.preventDefault(),t&&i.stopPropagation())},En=(i,t,e,n)=>{i.addEventListener(t,e,n)},On=i=>{if(i.jquery)return i[0];if(i instanceof HTMLElement)return i;if(Bi(i)){var t=document.createElement("template");return t.innerHTML=i.trim(),t.content.firstChild}return document.querySelector(i)},Bi=i=>typeof i=="string"&&i.indexOf("<")>-1;function An(i){let t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},i);var e=this;if(t.append){var n='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+Ri(t.title)+'">'+t.label+"</a>";e.hook("after","setupTemplates",()=>{var r=e.settings.render.item;e.settings.render.item=(o,s)=>{var a=On(r.call(e,o,s)),c=On(n);return a.appendChild(c),En(c,"mousedown",l=>{Sn(l,!0)}),En(c,"click",l=>{e.isLocked||(Sn(l,!0),!e.isLocked&&e.shouldDelete([a],l)&&(e.removeItem(a),e.refreshOptions(!1),e.inputState()))}),a}})}}function Cn(i){let t=this,e=Object.assign({text:n=>n[t.settings.labelField]},i);t.on("item_remove",function(n){if(t.isFocused&&t.control_input.value.trim()===""){var r=t.options[n];r&&t.setTextboxValue(e.text.call(t,r))}})}rt.define("caret_position",bn);rt.define("dropdown_input",wn);rt.define("no_backspace_delete",_n);rt.define("remove_button",An);rt.define("restore_on_backspace",Cn);var xn=rt;function Dn(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,n)}return e}function st(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Dn(Object(e),!0).forEach(function(n){Hi(i,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Dn(Object(e)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))})}return i}function ce(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ce=function(t){return typeof t}:ce=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ce(i)}function Hi(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function ut(){return ut=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},ut.apply(this,arguments)}function Ki(i,t){if(i==null)return{};var e={},n=Object.keys(i),r,o;for(o=0;o<n.length;o++)r=n[o],!(t.indexOf(r)>=0)&&(e[r]=i[r]);return e}function Yi(i,t){if(i==null)return{};var e=Ki(i,t),n,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(e[n]=i[n])}return e}var $i="1.15.6";function ct(i){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(i)}var dt=ct(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Gt=ct(/Edge/i),In=ct(/firefox/i),Yt=ct(/safari/i)&&!ct(/chrome/i)&&!ct(/android/i),Ge=ct(/iP(ad|od|hone)/i),Rn=ct(/chrome/i)&&ct(/android/i),Bn={capture:!1,passive:!1};function x(i,t,e){i.addEventListener(t,e,!dt&&Bn)}function A(i,t,e){i.removeEventListener(t,e,!dt&&Bn)}function he(i,t){if(t){if(t[0]===">"&&(t=t.substring(1)),i)try{if(i.matches)return i.matches(t);if(i.msMatchesSelector)return i.msMatchesSelector(t);if(i.webkitMatchesSelector)return i.webkitMatchesSelector(t)}catch{return!1}return!1}}function Hn(i){return i.host&&i!==document&&i.host.nodeType?i.host:i.parentNode}function nt(i,t,e,n){if(i){e=e||document;do{if(t!=null&&(t[0]===">"?i.parentNode===e&&he(i,t):he(i,t))||n&&i===e)return i;if(i===e)break}while(i=Hn(i))}return null}var Tn=/\s+/g;function U(i,t,e){if(i&&t)if(i.classList)i.classList[e?"add":"remove"](t);else{var n=(" "+i.className+" ").replace(Tn," ").replace(" "+t+" "," ");i.className=(n+(e?" "+t:"")).replace(Tn," ")}}function y(i,t,e){var n=i&&i.style;if(n){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(i,""):i.currentStyle&&(e=i.currentStyle),t===void 0?e:e[t];!(t in n)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),n[t]=e+(typeof e=="string"?"":"px")}}function xt(i,t){var e="";if(typeof i=="string")e=i;else do{var n=y(i,"transform");n&&n!=="none"&&(e=n+" "+e)}while(!t&&(i=i.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(e)}function Kn(i,t,e){if(i){var n=i.getElementsByTagName(t),r=0,o=n.length;if(e)for(;r<o;r++)e(n[r],r);return n}return[]}function ot(){var i=document.scrollingElement;return i||document.documentElement}function H(i,t,e,n,r){if(!(!i.getBoundingClientRect&&i!==window)){var o,s,a,c,l,u,d;if(i!==window&&i.parentNode&&i!==ot()?(o=i.getBoundingClientRect(),s=o.top,a=o.left,c=o.bottom,l=o.right,u=o.height,d=o.width):(s=0,a=0,c=window.innerHeight,l=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||e)&&i!==window&&(r=r||i.parentNode,!dt))do if(r&&r.getBoundingClientRect&&(y(r,"transform")!=="none"||e&&y(r,"position")!=="static")){var h=r.getBoundingClientRect();s-=h.top+parseInt(y(r,"border-top-width")),a-=h.left+parseInt(y(r,"border-left-width")),c=s+o.height,l=a+o.width;break}while(r=r.parentNode);if(n&&i!==window){var v=xt(r||i),f=v&&v.a,m=v&&v.d;v&&(s/=m,a/=f,d/=f,u/=m,c=s+u,l=a+d)}return{top:s,left:a,bottom:c,right:l,width:d,height:u}}}function Pn(i,t,e){for(var n=bt(i,!0),r=H(i)[t];n;){var o=H(n)[e],s=void 0;if(e==="top"||e==="left"?s=r>=o:s=r<=o,!s)return n;if(n===ot())break;n=bt(n,!1)}return!1}function Dt(i,t,e,n){for(var r=0,o=0,s=i.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==w.ghost&&(n||s[o]!==w.dragged)&&nt(s[o],e.draggable,i,!1)){if(r===t)return s[o];r++}o++}return null}function ze(i,t){for(var e=i.lastElementChild;e&&(e===w.ghost||y(e,"display")==="none"||t&&!he(e,t));)e=e.previousElementSibling;return e||null}function Z(i,t){var e=0;if(!i||!i.parentNode)return-1;for(;i=i.previousElementSibling;)i.nodeName.toUpperCase()!=="TEMPLATE"&&i!==w.clone&&(!t||he(i,t))&&e++;return e}function Fn(i){var t=0,e=0,n=ot();if(i)do{var r=xt(i),o=r.a,s=r.d;t+=i.scrollLeft*o,e+=i.scrollTop*s}while(i!==n&&(i=i.parentNode));return[t,e]}function qi(i,t){for(var e in i)if(i.hasOwnProperty(e)){for(var n in t)if(t.hasOwnProperty(n)&&t[n]===i[e][n])return Number(e)}return-1}function bt(i,t){if(!i||!i.getBoundingClientRect)return ot();var e=i,n=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var r=y(e);if(e.clientWidth<e.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return ot();if(n||t)return e;n=!0}}while(e=e.parentNode);return ot()}function Vi(i,t){if(i&&t)for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function Ne(i,t){return Math.round(i.top)===Math.round(t.top)&&Math.round(i.left)===Math.round(t.left)&&Math.round(i.height)===Math.round(t.height)&&Math.round(i.width)===Math.round(t.width)}var $t;function Yn(i,t){return function(){if(!$t){var e=arguments,n=this;e.length===1?i.call(n,e[0]):i.apply(n,e),$t=setTimeout(function(){$t=void 0},t)}}}function ji(){clearTimeout($t),$t=void 0}function $n(i,t,e){i.scrollLeft+=t,i.scrollTop+=e}function qn(i){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(i).cloneNode(!0):e?e(i).clone(!0)[0]:i.cloneNode(!0)}function Vn(i,t,e){var n={};return Array.from(i.children).forEach(function(r){var o,s,a,c;if(!(!nt(r,t.draggable,i,!1)||r.animated||r===e)){var l=H(r);n.left=Math.min((o=n.left)!==null&&o!==void 0?o:1/0,l.left),n.top=Math.min((s=n.top)!==null&&s!==void 0?s:1/0,l.top),n.right=Math.max((a=n.right)!==null&&a!==void 0?a:-1/0,l.right),n.bottom=Math.max((c=n.bottom)!==null&&c!==void 0?c:-1/0,l.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var X="Sortable"+new Date().getTime();function Gi(){var i=[],t;return{captureAnimationState:function(){if(i=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(r){if(!(y(r,"display")==="none"||r===w.ghost)){i.push({target:r,rect:H(r)});var o=st({},i[i.length-1].rect);if(r.thisAnimationDuration){var s=xt(r,!0);s&&(o.top-=s.f,o.left-=s.e)}r.fromRect=o}})}},addAnimationState:function(n){i.push(n)},removeAnimationState:function(n){i.splice(qi(i,{target:n}),1)},animateAll:function(n){var r=this;if(!this.options.animation){clearTimeout(t),typeof n=="function"&&n();return}var o=!1,s=0;i.forEach(function(a){var c=0,l=a.target,u=l.fromRect,d=H(l),h=l.prevFromRect,v=l.prevToRect,f=a.rect,m=xt(l,!0);m&&(d.top-=m.f,d.left-=m.e),l.toRect=d,l.thisAnimationDuration&&Ne(h,d)&&!Ne(u,d)&&(f.top-d.top)/(f.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(c=Xi(f,h,v,r.options)),Ne(d,u)||(l.prevFromRect=u,l.prevToRect=d,c||(c=r.options.animation),r.animate(l,f,d,c)),c&&(o=!0,s=Math.max(s,c),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0,l.prevFromRect=null,l.fromRect=null,l.prevToRect=null,l.thisAnimationDuration=null},c),l.thisAnimationDuration=c)}),clearTimeout(t),o?t=setTimeout(function(){typeof n=="function"&&n()},s):typeof n=="function"&&n(),i=[]},animate:function(n,r,o,s){if(s){y(n,"transition",""),y(n,"transform","");var a=xt(this.el),c=a&&a.a,l=a&&a.d,u=(r.left-o.left)/(c||1),d=(r.top-o.top)/(l||1);n.animatingX=!!u,n.animatingY=!!d,y(n,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=zi(n),y(n,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),y(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){y(n,"transition",""),y(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},s)}}}}function zi(i){return i.offsetWidth}function Xi(i,t,e,n){return Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*n.animation}var Et=[],ke={initializeByDefault:!0},zt={mount:function(t){for(var e in ke)ke.hasOwnProperty(e)&&!(e in t)&&(t[e]=ke[e]);Et.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Et.push(t)},pluginEvent:function(t,e,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var o=t+"Global";Et.forEach(function(s){e[s.pluginName]&&(e[s.pluginName][o]&&e[s.pluginName][o](st({sortable:e},n)),e.options[s.pluginName]&&e[s.pluginName][t]&&e[s.pluginName][t](st({sortable:e},n)))})},initializePlugins:function(t,e,n,r){Et.forEach(function(a){var c=a.pluginName;if(!(!t.options[c]&&!a.initializeByDefault)){var l=new a(t,e,t.options);l.sortable=t,l.options=t.options,t[c]=l,ut(n,l.defaults)}});for(var o in t.options)if(t.options.hasOwnProperty(o)){var s=this.modifyOption(t,o,t.options[o]);typeof s<"u"&&(t.options[o]=s)}},getEventProperties:function(t,e){var n={};return Et.forEach(function(r){typeof r.eventProperties=="function"&&ut(n,r.eventProperties.call(e[r.pluginName],t))}),n},modifyOption:function(t,e,n){var r;return Et.forEach(function(o){t[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[e]=="function"&&(r=o.optionListeners[e].call(t[o.pluginName],n))}),r}};function Wi(i){var t=i.sortable,e=i.rootEl,n=i.name,r=i.targetEl,o=i.cloneEl,s=i.toEl,a=i.fromEl,c=i.oldIndex,l=i.newIndex,u=i.oldDraggableIndex,d=i.newDraggableIndex,h=i.originalEvent,v=i.putSortable,f=i.extraEventProperties;if(t=t||e&&e[X],!!t){var m,I=t.options,D="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!dt&&!Gt?m=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent(n,!0,!0)),m.to=s||e,m.from=a||e,m.item=r||e,m.clone=o,m.oldIndex=c,m.newIndex=l,m.oldDraggableIndex=u,m.newDraggableIndex=d,m.originalEvent=h,m.pullMode=v?v.lastPutMode:void 0;var g=st(st({},f),zt.getEventProperties(n,t));for(var C in g)m[C]=g[C];e&&e.dispatchEvent(m),I[D]&&I[D].call(t,m)}}var Ui=["evt"],z=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.evt,o=Yi(n,Ui);zt.pluginEvent.bind(w)(t,e,st({dragEl:p,parentEl:L,ghostEl:_,rootEl:F,nextEl:St,lastDownEl:ue,cloneEl:k,cloneHidden:vt,dragStarted:Bt,putSortable:Y,activeSortable:w.active,originalEvent:r,oldIndex:Ct,oldDraggableIndex:qt,newIndex:Q,newDraggableIndex:mt,hideGhostForTarget:Xn,unhideGhostForTarget:Wn,cloneNowHidden:function(){vt=!0},cloneNowShown:function(){vt=!1},dispatchSortableEvent:function(a){V({sortable:e,name:a,originalEvent:r})}},o))};function V(i){Wi(st({putSortable:Y,cloneEl:k,targetEl:p,rootEl:F,oldIndex:Ct,oldDraggableIndex:qt,newIndex:Q,newDraggableIndex:mt},i))}var p,L,_,F,St,ue,k,vt,Ct,Q,qt,mt,oe,Y,At=!1,ge=!1,me=[],wt,et,Me,Le,Nn,kn,Bt,Ot,Vt,jt=!1,se=!1,de,q,Re=[],$e=!1,ve=[],ye=typeof document<"u",ae=Ge,Mn=Gt||dt?"cssFloat":"float",Qi=ye&&!Rn&&!Ge&&"draggable"in document.createElement("div"),jn=function(){if(ye){if(dt)return!1;var i=document.createElement("x");return i.style.cssText="pointer-events:auto",i.style.pointerEvents==="auto"}}(),Gn=function(t,e){var n=y(t),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=Dt(t,0,e),s=Dt(t,1,e),a=o&&y(o),c=s&&y(s),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+H(o).width,u=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+H(s).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&a.float!=="none"){var d=a.float==="left"?"left":"right";return s&&(c.clear==="both"||c.clear===d)?"vertical":"horizontal"}return o&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||l>=r&&n[Mn]==="none"||s&&n[Mn]==="none"&&l+u>r)?"vertical":"horizontal"},Ji=function(t,e,n){var r=n?t.left:t.top,o=n?t.right:t.bottom,s=n?t.width:t.height,a=n?e.left:e.top,c=n?e.right:e.bottom,l=n?e.width:e.height;return r===a||o===c||r+s/2===a+l/2},Zi=function(t,e){var n;return me.some(function(r){var o=r[X].options.emptyInsertThreshold;if(!(!o||ze(r))){var s=H(r),a=t>=s.left-o&&t<=s.right+o,c=e>=s.top-o&&e<=s.bottom+o;if(a&&c)return n=r}}),n},zn=function(t){function e(o,s){return function(a,c,l,u){var d=a.options.group.name&&c.options.group.name&&a.options.group.name===c.options.group.name;if(o==null&&(s||d))return!0;if(o==null||o===!1)return!1;if(s&&o==="clone")return o;if(typeof o=="function")return e(o(a,c,l,u),s)(a,c,l,u);var h=(s?a:c).options.group.name;return o===!0||typeof o=="string"&&o===h||o.join&&o.indexOf(h)>-1}}var n={},r=t.group;(!r||ce(r)!="object")&&(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n},Xn=function(){!jn&&_&&y(_,"display","none")},Wn=function(){!jn&&_&&y(_,"display","")};ye&&!Rn&&document.addEventListener("click",function(i){if(ge)return i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.stopImmediatePropagation&&i.stopImmediatePropagation(),ge=!1,!1},!0);var _t=function(t){if(p){t=t.touches?t.touches[0]:t;var e=Zi(t.clientX,t.clientY);if(e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[X]._onDragOver(n)}}},tr=function(t){p&&p.parentNode[X]._isOutsideThisEl(t.target)};function w(i,t){if(!(i&&i.nodeType&&i.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(i));this.el=i,this.options=t=ut({},t),i[X]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(i.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Gn(i,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,a){s.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:w.supportPointer!==!1&&"PointerEvent"in window&&(!Yt||Ge),emptyInsertThreshold:5};zt.initializePlugins(this,i,e);for(var n in e)!(n in t)&&(t[n]=e[n]);zn(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:Qi,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?x(i,"pointerdown",this._onTapStart):(x(i,"mousedown",this._onTapStart),x(i,"touchstart",this._onTapStart)),this.nativeDraggable&&(x(i,"dragover",this),x(i,"dragenter",this)),me.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ut(this,Gi())}w.prototype={constructor:w,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ot=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,p):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,r=this.options,o=r.preventOnFilter,s=t.type,a=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,c=(a||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||c,u=r.filter;if(lr(n),!p&&!(/mousedown|pointerdown/.test(s)&&t.button!==0||r.disabled)&&!l.isContentEditable&&!(!this.nativeDraggable&&Yt&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=nt(c,r.draggable,n,!1),!(c&&c.animated)&&ue!==c)){if(Ct=Z(c),qt=Z(c,r.draggable),typeof u=="function"){if(u.call(this,t,c,this)){V({sortable:e,rootEl:l,name:"filter",targetEl:c,toEl:n,fromEl:n}),z("filter",e,{evt:t}),o&&t.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=nt(l,d.trim(),n,!1),d)return V({sortable:e,rootEl:d,name:"filter",targetEl:c,fromEl:n,toEl:n}),z("filter",e,{evt:t}),!0}),u)){o&&t.preventDefault();return}r.handle&&!nt(l,r.handle,n,!1)||this._prepareDragStart(t,a,c)}}},_prepareDragStart:function(t,e,n){var r=this,o=r.el,s=r.options,a=o.ownerDocument,c;if(n&&!p&&n.parentNode===o){var l=H(n);if(F=o,p=n,L=p.parentNode,St=p.nextSibling,ue=n,oe=s.group,w.dragged=p,wt={target:p,clientX:(e||t).clientX,clientY:(e||t).clientY},Nn=wt.clientX-l.left,kn=wt.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,p.style["will-change"]="all",c=function(){if(z("delayEnded",r,{evt:t}),w.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!In&&r.nativeDraggable&&(p.draggable=!0),r._triggerDragStart(t,e),V({sortable:r,name:"choose",originalEvent:t}),U(p,s.chosenClass,!0)},s.ignore.split(",").forEach(function(u){Kn(p,u.trim(),Be)}),x(a,"dragover",_t),x(a,"mousemove",_t),x(a,"touchmove",_t),s.supportPointer?(x(a,"pointerup",r._onDrop),!this.nativeDraggable&&x(a,"pointercancel",r._onDrop)):(x(a,"mouseup",r._onDrop),x(a,"touchend",r._onDrop),x(a,"touchcancel",r._onDrop)),In&&this.nativeDraggable&&(this.options.touchStartThreshold=4,p.draggable=!0),z("delayStart",this,{evt:t}),s.delay&&(!s.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Gt||dt))){if(w.eventCanceled){this._onDrop();return}s.supportPointer?(x(a,"pointerup",r._disableDelayedDrag),x(a,"pointercancel",r._disableDelayedDrag)):(x(a,"mouseup",r._disableDelayedDrag),x(a,"touchend",r._disableDelayedDrag),x(a,"touchcancel",r._disableDelayedDrag)),x(a,"mousemove",r._delayedDragTouchMoveHandler),x(a,"touchmove",r._delayedDragTouchMoveHandler),s.supportPointer&&x(a,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(c,s.delay)}else c()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){p&&Be(p),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;A(t,"mouseup",this._disableDelayedDrag),A(t,"touchend",this._disableDelayedDrag),A(t,"touchcancel",this._disableDelayedDrag),A(t,"pointerup",this._disableDelayedDrag),A(t,"pointercancel",this._disableDelayedDrag),A(t,"mousemove",this._delayedDragTouchMoveHandler),A(t,"touchmove",this._delayedDragTouchMoveHandler),A(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?x(document,"pointermove",this._onTouchMove):e?x(document,"touchmove",this._onTouchMove):x(document,"mousemove",this._onTouchMove):(x(p,"dragend",this),x(F,"dragstart",this._onDragStart));try{document.selection?fe(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(At=!1,F&&p){z("dragStarted",this,{evt:e}),this.nativeDraggable&&x(document,"dragover",tr);var n=this.options;!t&&U(p,n.dragClass,!1),U(p,n.ghostClass,!0),w.active=this,t&&this._appendGhost(),V({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(et){this._lastX=et.clientX,this._lastY=et.clientY,Xn();for(var t=document.elementFromPoint(et.clientX,et.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(et.clientX,et.clientY),t!==e);)e=t;if(p.parentNode[X]._isOutsideThisEl(t),e)do{if(e[X]){var n=void 0;if(n=e[X]._onDragOver({clientX:et.clientX,clientY:et.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=Hn(e));Wn()}},_onTouchMove:function(t){if(wt){var e=this.options,n=e.fallbackTolerance,r=e.fallbackOffset,o=t.touches?t.touches[0]:t,s=_&&xt(_,!0),a=_&&s&&s.a,c=_&&s&&s.d,l=ae&&q&&Fn(q),u=(o.clientX-wt.clientX+r.x)/(a||1)+(l?l[0]-Re[0]:0)/(a||1),d=(o.clientY-wt.clientY+r.y)/(c||1)+(l?l[1]-Re[1]:0)/(c||1);if(!w.active&&!At){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(_){s?(s.e+=u-(Me||0),s.f+=d-(Le||0)):s={a:1,b:0,c:0,d:1,e:u,f:d};var h="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");y(_,"webkitTransform",h),y(_,"mozTransform",h),y(_,"msTransform",h),y(_,"transform",h),Me=u,Le=d,et=o}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!_){var t=this.options.fallbackOnBody?document.body:F,e=H(p,!0,ae,!0,t),n=this.options;if(ae){for(q=t;y(q,"position")==="static"&&y(q,"transform")==="none"&&q!==document;)q=q.parentNode;q!==document.body&&q!==document.documentElement?(q===document&&(q=ot()),e.top+=q.scrollTop,e.left+=q.scrollLeft):q=ot(),Re=Fn(q)}_=p.cloneNode(!0),U(_,n.ghostClass,!1),U(_,n.fallbackClass,!0),U(_,n.dragClass,!0),y(_,"transition",""),y(_,"transform",""),y(_,"box-sizing","border-box"),y(_,"margin",0),y(_,"top",e.top),y(_,"left",e.left),y(_,"width",e.width),y(_,"height",e.height),y(_,"opacity","0.8"),y(_,"position",ae?"absolute":"fixed"),y(_,"zIndex","100000"),y(_,"pointerEvents","none"),w.ghost=_,t.appendChild(_),y(_,"transform-origin",Nn/parseInt(_.style.width)*100+"% "+kn/parseInt(_.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,o=n.options;if(z("dragStart",this,{evt:t}),w.eventCanceled){this._onDrop();return}z("setupClone",this),w.eventCanceled||(k=qn(p),k.removeAttribute("id"),k.draggable=!1,k.style["will-change"]="",this._hideClone(),U(k,this.options.chosenClass,!1),w.clone=k),n.cloneId=fe(function(){z("clone",n),!w.eventCanceled&&(n.options.removeCloneOnHide||F.insertBefore(k,p),n._hideClone(),V({sortable:n,name:"clone"}))}),!e&&U(p,o.dragClass,!0),e?(ge=!0,n._loopId=setInterval(n._emulateDragOver,50)):(A(document,"mouseup",n._onDrop),A(document,"touchend",n._onDrop),A(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(n,r,p)),x(document,"drop",n),y(p,"transform","translateZ(0)")),At=!0,n._dragStartId=fe(n._dragStarted.bind(n,e,t)),x(document,"selectstart",n),Bt=!0,window.getSelection().removeAllRanges(),Yt&&y(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,n=t.target,r,o,s,a=this.options,c=a.group,l=w.active,u=oe===c,d=a.sort,h=Y||l,v,f=this,m=!1;if($e)return;function I(It,Jn){z(It,f,st({evt:t,isOwner:u,axis:v?"vertical":"horizontal",revert:s,dragRect:r,targetRect:o,canSort:d,fromSortable:h,target:n,completed:g,onMove:function(Ue,Zn){return le(F,e,p,r,Ue,H(Ue),t,Zn)},changed:C},Jn))}function D(){I("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function g(It){return I("dragOverCompleted",{insertion:It}),It&&(u?l._hideClone():l._showClone(f),f!==h&&(U(p,Y?Y.options.ghostClass:l.options.ghostClass,!1),U(p,a.ghostClass,!0)),Y!==f&&f!==w.active?Y=f:f===w.active&&Y&&(Y=null),h===f&&(f._ignoreWhileAnimating=n),f.animateAll(function(){I("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===p&&!p.animated||n===e&&!n.animated)&&(Ot=null),!a.dragoverBubble&&!t.rootEl&&n!==document&&(p.parentNode[X]._isOutsideThisEl(t.target),!It&&_t(t)),!a.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function C(){Q=Z(p),mt=Z(p,a.draggable),V({sortable:f,name:"change",toEl:e,newIndex:Q,newDraggableIndex:mt,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=nt(n,a.draggable,e,!0),I("dragOver"),w.eventCanceled)return m;if(p.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||f._ignoreWhileAnimating===n)return g(!1);if(ge=!1,l&&!a.disabled&&(u?d||(s=L!==F):Y===this||(this.lastPutMode=oe.checkPull(this,l,p,t))&&c.checkPut(this,l,p,t))){if(v=this._getDirection(t,n)==="vertical",r=H(p),I("dragOverValid"),w.eventCanceled)return m;if(s)return L=F,D(),this._hideClone(),I("revert"),w.eventCanceled||(St?F.insertBefore(p,St):F.appendChild(p)),g(!0);var P=ze(e,a.draggable);if(!P||rr(t,v,this)&&!P.animated){if(P===p)return g(!1);if(P&&e===t.target&&(n=P),n&&(o=H(n)),le(F,e,p,r,n,o,t,!!n)!==!1)return D(),P&&P.nextSibling?e.insertBefore(p,P.nextSibling):e.appendChild(p),L=e,C(),g(!0)}else if(P&&ir(t,v,this)){var J=Dt(e,0,a,!0);if(J===p)return g(!1);if(n=J,o=H(n),le(F,e,p,r,n,o,t,!1)!==!1)return D(),e.insertBefore(p,J),L=e,C(),g(!0)}else if(n.parentNode===e){o=H(n);var K=0,S,O=p.parentNode!==e,b=!Ji(p.animated&&p.toRect||r,n.animated&&n.toRect||o,v),M=v?"top":"left",E=Pn(n,"top","top")||Pn(p,"top","top"),it=E?E.scrollTop:void 0;Ot!==n&&(S=o[M],jt=!1,se=!b&&a.invertSwap||O),K=or(t,n,o,v,b?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,se,Ot===n);var j;if(K!==0){var at=Z(p);do at-=K,j=L.children[at];while(j&&(y(j,"display")==="none"||j===_))}if(K===0||j===n)return g(!1);Ot=n,Vt=K;var yt=n.nextElementSibling,ft=!1;ft=K===1;var Xt=le(F,e,p,r,n,o,t,ft);if(Xt!==!1)return(Xt===1||Xt===-1)&&(ft=Xt===1),$e=!0,setTimeout(nr,30),D(),ft&&!yt?e.appendChild(p):n.parentNode.insertBefore(p,ft?yt:n),E&&$n(E,0,it-E.scrollTop),L=p.parentNode,S!==void 0&&!se&&(de=Math.abs(S-H(n)[M])),C(),g(!0)}if(e.contains(p))return g(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){A(document,"mousemove",this._onTouchMove),A(document,"touchmove",this._onTouchMove),A(document,"pointermove",this._onTouchMove),A(document,"dragover",_t),A(document,"mousemove",_t),A(document,"touchmove",_t)},_offUpEvents:function(){var t=this.el.ownerDocument;A(t,"mouseup",this._onDrop),A(t,"touchend",this._onDrop),A(t,"pointerup",this._onDrop),A(t,"pointercancel",this._onDrop),A(t,"touchcancel",this._onDrop),A(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;if(Q=Z(p),mt=Z(p,n.draggable),z("drop",this,{evt:t}),L=p&&p.parentNode,Q=Z(p),mt=Z(p,n.draggable),w.eventCanceled){this._nulling();return}At=!1,se=!1,jt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),qe(this.cloneId),qe(this._dragStartId),this.nativeDraggable&&(A(document,"drop",this),A(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Yt&&y(document.body,"user-select",""),y(p,"transform",""),t&&(Bt&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),_&&_.parentNode&&_.parentNode.removeChild(_),(F===L||Y&&Y.lastPutMode!=="clone")&&k&&k.parentNode&&k.parentNode.removeChild(k),p&&(this.nativeDraggable&&A(p,"dragend",this),Be(p),p.style["will-change"]="",Bt&&!At&&U(p,Y?Y.options.ghostClass:this.options.ghostClass,!1),U(p,this.options.chosenClass,!1),V({sortable:this,name:"unchoose",toEl:L,newIndex:null,newDraggableIndex:null,originalEvent:t}),F!==L?(Q>=0&&(V({rootEl:L,name:"add",toEl:L,fromEl:F,originalEvent:t}),V({sortable:this,name:"remove",toEl:L,originalEvent:t}),V({rootEl:L,name:"sort",toEl:L,fromEl:F,originalEvent:t}),V({sortable:this,name:"sort",toEl:L,originalEvent:t})),Y&&Y.save()):Q!==Ct&&Q>=0&&(V({sortable:this,name:"update",toEl:L,originalEvent:t}),V({sortable:this,name:"sort",toEl:L,originalEvent:t})),w.active&&((Q==null||Q===-1)&&(Q=Ct,mt=qt),V({sortable:this,name:"end",toEl:L,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){z("nulling",this),F=p=L=_=St=k=ue=vt=wt=et=Bt=Q=mt=Ct=qt=Ot=Vt=Y=oe=w.dragged=w.ghost=w.clone=w.active=null,ve.forEach(function(t){t.checked=!0}),ve.length=Me=Le=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":p&&(this._onDragOver(t),er(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,n=this.el.children,r=0,o=n.length,s=this.options;r<o;r++)e=n[r],nt(e,s.draggable,this.el,!1)&&t.push(e.getAttribute(s.dataIdAttr)||ar(e));return t},sort:function(t,e){var n={},r=this.el;this.toArray().forEach(function(o,s){var a=r.children[s];nt(a,this.options.draggable,r,!1)&&(n[o]=a)},this),e&&this.captureAnimationState(),t.forEach(function(o){n[o]&&(r.removeChild(n[o]),r.appendChild(n[o]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return nt(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(e===void 0)return n[t];var r=zt.modifyOption(this,t,e);typeof r<"u"?n[t]=r:n[t]=e,t==="group"&&zn(n)},destroy:function(){z("destroy",this);var t=this.el;t[X]=null,A(t,"mousedown",this._onTapStart),A(t,"touchstart",this._onTapStart),A(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(A(t,"dragover",this),A(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),me.splice(me.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!vt){if(z("hideClone",this),w.eventCanceled)return;y(k,"display","none"),this.options.removeCloneOnHide&&k.parentNode&&k.parentNode.removeChild(k),vt=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(vt){if(z("showClone",this),w.eventCanceled)return;p.parentNode==F&&!this.options.group.revertClone?F.insertBefore(k,p):St?F.insertBefore(k,St):F.appendChild(k),this.options.group.revertClone&&this.animate(p,k),y(k,"display",""),vt=!1}}};function er(i){i.dataTransfer&&(i.dataTransfer.dropEffect="move"),i.cancelable&&i.preventDefault()}function le(i,t,e,n,r,o,s,a){var c,l=i[X],u=l.options.onMove,d;return window.CustomEvent&&!dt&&!Gt?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=t,c.from=i,c.dragged=e,c.draggedRect=n,c.related=r||t,c.relatedRect=o||H(t),c.willInsertAfter=a,c.originalEvent=s,i.dispatchEvent(c),u&&(d=u.call(l,c,s)),d}function Be(i){i.draggable=!1}function nr(){$e=!1}function ir(i,t,e){var n=H(Dt(e.el,0,e.options,!0)),r=Vn(e.el,e.options,_),o=10;return t?i.clientX<r.left-o||i.clientY<n.top&&i.clientX<n.right:i.clientY<r.top-o||i.clientY<n.bottom&&i.clientX<n.left}function rr(i,t,e){var n=H(ze(e.el,e.options.draggable)),r=Vn(e.el,e.options,_),o=10;return t?i.clientX>r.right+o||i.clientY>n.bottom&&i.clientX>n.left:i.clientY>r.bottom+o||i.clientX>n.right&&i.clientY>n.top}function or(i,t,e,n,r,o,s,a){var c=n?i.clientY:i.clientX,l=n?e.height:e.width,u=n?e.top:e.left,d=n?e.bottom:e.right,h=!1;if(!s){if(a&&de<l*r){if(!jt&&(Vt===1?c>u+l*o/2:c<d-l*o/2)&&(jt=!0),jt)h=!0;else if(Vt===1?c<u+de:c>d-de)return-Vt}else if(c>u+l*(1-r)/2&&c<d-l*(1-r)/2)return sr(t)}return h=h||s,h&&(c<u+l*o/2||c>d-l*o/2)?c>u+l/2?1:-1:0}function sr(i){return Z(p)<Z(i)?1:-1}function ar(i){for(var t=i.tagName+i.className+i.src+i.href+i.textContent,e=t.length,n=0;e--;)n+=t.charCodeAt(e);return n.toString(36)}function lr(i){ve.length=0;for(var t=i.getElementsByTagName("input"),e=t.length;e--;){var n=t[e];n.checked&&ve.push(n)}}function fe(i){return setTimeout(i,0)}function qe(i){return clearTimeout(i)}ye&&x(document,"touchmove",function(i){(w.active||At)&&i.cancelable&&i.preventDefault()});w.utils={on:x,off:A,css:y,find:Kn,is:function(t,e){return!!nt(t,e,t,!1)},extend:Vi,throttle:Yn,closest:nt,toggleClass:U,clone:qn,index:Z,nextTick:fe,cancelNextTick:qe,detectDirection:Gn,getChild:Dt,expando:X};w.get=function(i){return i[X]};w.mount=function(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(w.utils=st(st({},w.utils),n.utils)),zt.mount(n)})};w.create=function(i,t){return new w(i,t)};w.version=$i;var B=[],Ht,Ve,je=!1,He,Ke,be,Kt;function cr(){function i(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return i.prototype={dragStarted:function(e){var n=e.originalEvent;this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):this.options.supportPointer?x(document,"pointermove",this._handleFallbackAutoScroll):n.touches?x(document,"touchmove",this._handleFallbackAutoScroll):x(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var n=e.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):(A(document,"pointermove",this._handleFallbackAutoScroll),A(document,"touchmove",this._handleFallbackAutoScroll),A(document,"mousemove",this._handleFallbackAutoScroll)),Ln(),pe(),ji()},nulling:function(){be=Ve=Ht=je=Kt=He=Ke=null,B.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,n){var r=this,o=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(o,s);if(be=e,n||this.options.forceAutoScrollFallback||Gt||dt||Yt){Ye(e,this.options,a,n);var c=bt(a,!0);je&&(!Kt||o!==He||s!==Ke)&&(Kt&&Ln(),Kt=setInterval(function(){var l=bt(document.elementFromPoint(o,s),!0);l!==c&&(c=l,pe()),Ye(e,r.options,l,n)},10),He=o,Ke=s)}else{if(!this.options.bubbleScroll||bt(a,!0)===ot()){pe();return}Ye(e,this.options,bt(a,!1),!1)}}},ut(i,{pluginName:"scroll",initializeByDefault:!0})}function pe(){B.forEach(function(i){clearInterval(i.pid)}),B=[]}function Ln(){clearInterval(Kt)}var Ye=Yn(function(i,t,e,n){if(t.scroll){var r=(i.touches?i.touches[0]:i).clientX,o=(i.touches?i.touches[0]:i).clientY,s=t.scrollSensitivity,a=t.scrollSpeed,c=ot(),l=!1,u;Ve!==e&&(Ve=e,pe(),Ht=t.scroll,u=t.scrollFn,Ht===!0&&(Ht=bt(e,!0)));var d=0,h=Ht;do{var v=h,f=H(v),m=f.top,I=f.bottom,D=f.left,g=f.right,C=f.width,P=f.height,J=void 0,K=void 0,S=v.scrollWidth,O=v.scrollHeight,b=y(v),M=v.scrollLeft,E=v.scrollTop;v===c?(J=C<S&&(b.overflowX==="auto"||b.overflowX==="scroll"||b.overflowX==="visible"),K=P<O&&(b.overflowY==="auto"||b.overflowY==="scroll"||b.overflowY==="visible")):(J=C<S&&(b.overflowX==="auto"||b.overflowX==="scroll"),K=P<O&&(b.overflowY==="auto"||b.overflowY==="scroll"));var it=J&&(Math.abs(g-r)<=s&&M+C<S)-(Math.abs(D-r)<=s&&!!M),j=K&&(Math.abs(I-o)<=s&&E+P<O)-(Math.abs(m-o)<=s&&!!E);if(!B[d])for(var at=0;at<=d;at++)B[at]||(B[at]={});(B[d].vx!=it||B[d].vy!=j||B[d].el!==v)&&(B[d].el=v,B[d].vx=it,B[d].vy=j,clearInterval(B[d].pid),(it!=0||j!=0)&&(l=!0,B[d].pid=setInterval(function(){n&&this.layer===0&&w.active._onTouchMove(be);var yt=B[this.layer].vy?B[this.layer].vy*a:0,ft=B[this.layer].vx?B[this.layer].vx*a:0;typeof u=="function"&&u.call(w.dragged.parentNode[X],ft,yt,i,be,B[this.layer].el)!=="continue"||$n(B[this.layer].el,ft,yt)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==c&&(h=bt(h,!1)));je=l}},30),Un=function(t){var e=t.originalEvent,n=t.putSortable,r=t.dragEl,o=t.activeSortable,s=t.dispatchSortableEvent,a=t.hideGhostForTarget,c=t.unhideGhostForTarget;if(e){var l=n||o;a();var u=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,d=document.elementFromPoint(u.clientX,u.clientY);c(),l&&!l.el.contains(d)&&(s("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function Xe(){}Xe.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=Dt(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:Un};ut(Xe,{pluginName:"revertOnSpill"});function We(){}We.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,r=n||this.sortable;r.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),r.animateAll()},drop:Un};ut(We,{pluginName:"removeOnSpill"});w.mount(new cr);w.mount(We,Xe);var Qn=w;var we=class i{constructor(t=".rs-util-settings-form"){typeof t=="object"?this.form=t:this.form=document.querySelector(t),this.form.settingsPage=this,this.init()}init(){this.form.querySelectorAll("[data-toggled-by]").forEach(o=>{let s=this.form.querySelector(`#${o.dataset.toggledBy}`);s&&this.showTogglableControls(s)}),this.form.querySelectorAll("[data-toggles-group]").forEach(o=>{let s;if(o.dataset.togglesGroup==="self"){s=o.closest(".rs-util-settings-field-group");let a=o.closest(".rs-util-settings-field-row"),c=s.children[0],l=s.children[1];l.setAttribute("aria-hidden",o.checked?"false":"true"),l.setAttribute("data-toggled-by",o.id),c.append(a)}else s=this.form.querySelector(`#${o.dataset.togglesGroup}`),s.setAttribute("aria-hidden",o.checked?"false":"true"),s.setAttribute("data-toggled-by",o.id);o.setAttribute("aria-expanded",o.checked?"true":"false"),o.setAttribute("aria-controls",`[data-toggled-by="${o.id}"]`),o.setAttribute("data-controls",`[data-toggled-by="${o.id}"]`)}),this.form.querySelectorAll("[data-ordered]").forEach((o,s)=>{let a=o.querySelector("input[data-ordering-field]");if(!(a?.value??!1))return;o.currentOrder=a.value||s+1;let c=document.createElement("div");c.classList.add("rs-util-settings-field-row-order-controls"),o.append(c);let l=document.createElement("button");l.type="button",l.textContent="Move field up",l.setAttribute("data-action","move-up"),l.classList.add("button","rs-util-settings-field-row-ordering","rs-util-settings-field-row-ordering--up"),c.append(l);let u=document.createElement("button");u.type="button",u.textContent="Move field down",u.setAttribute("data-action","move-down"),u.classList.add("button","rs-util-settings-field-row-ordering","rs-util-settings-field-row-ordering--down"),c.append(u);let d=document.createElement("button");d.type="button",d.textContent="Drag to reorder",d.classList.add("button","rs-util-settings-field-row-ordering","rs-util-settings-field-row-ordering--grabber"),c.append(d),o.parentElement.dataset.orderingGroup=o.dataset.ordered}),this.form.querySelectorAll("[data-ordering-group]").forEach(o=>{[...o.children].sort((s,a)=>s.currentOrder-a.currentOrder).forEach(s=>o.appendChild(s)),i.makeSortable(o,{handle:".rs-util-settings-field-row-ordering--grabber",onSort:()=>this.updateSortingIds(o)})}),document.querySelectorAll("[data-use-tom-select]").forEach(i.makeSelectable),i.listen("change",".rs-util-settings-form",o=>i.enableSaveButton(o)),i.listen("change","[data-controls]",o=>this.showTogglableControls(o)),i.listen("click",'[data-action="save-rs-util-page"]',()=>this.save()),i.listen("click",".rs-util-settings-page__tab-toggle",o=>this.clickTab(o)),i.listen("click",".rs-util-settings-field-row-ordering",o=>this.clickReorderButton(o)),i.listen("click",".rs-util-settings-page [data-action]",o=>this.handleAction(o)),window.addEventListener("popstate",this.onPopState)}handleAction(t){switch(t.dataset.action){case"remove-item":i.removeListItem(t.closest(".rs-util-settings-sortable-list-item")),i.enableSaveButton();break}}save(){this.form.classList.add("is-state-saving"),this.form.submit()}clickTab(t){history.pushState(null,null,`#${t.dataset.section}`),i.switchTab(t.dataset.section,this.form)}clickReorderButton(t){let e=t.closest(".rs-util-settings-field-row");if(!e.querySelector("input[data-ordering-field]"))return;let r=t.dataset.action==="move-up"?e.previousElementSibling:e.nextElementSibling;r&&(t.dataset.action==="move-up"?e.insertAdjacentElement("afterend",r):e.insertAdjacentElement("beforebegin",r),i.enableSaveButton(),this.updateSortingIds(e.closest("[data-ordering-group]")))}updateSortingIds(t){t.querySelectorAll(".rs-util-settings-field-row").forEach((n,r)=>{n.querySelector("input[data-ordering-field]").value=r+1,n.currentOrder=r+1})}showTogglableControls(t){let e=this.form.querySelectorAll(`[data-toggled-by="${t.id}"]`);e.forEach(n=>{n.setAttribute("aria-hidden",t.checked??(t.value||!1)?"false":"true")}),e.length&&(t.setAttribute("aria-expanded",t.checked??(t.value||!1)?"true":"false"),t.setAttribute("aria-controls",`[data-toggled-by="${t.id}"]`),t.setAttribute("data-controls",`[data-toggled-by="${t.id}"]`))}onPopState(){let e=new URL(window.location.href).hash.replace("#","");i.switchTab(e,this.form)}static enableSaveButton(){document.querySelector(".rs-util-settings-page .rs-util-settings-page__submit").disabled=!1}static switchTab(t,e){t||(t=e.querySelector(".rs-util-settings-section[data-section]").dataset.section),document.querySelectorAll(".rs-util-settings-page__tab-toggle").forEach(r=>{r.setAttribute("aria-expanded",r.dataset.section===t?"true":"false"),e.querySelector(`.rs-util-settings-section[data-section="${r.dataset.section}"]`).setAttribute("aria-hidden",r.dataset.section===t?"false":"true")})}static listen(t,e,n){document.addEventListener(t,r=>{let o=r.target.closest(e);o&&(r.preventDefault(),n(o,r))})}static makeSelectable(t,e={}){let n=(o,s,...a)=>(document.dispatchEvent(new CustomEvent(`rs-util-select-${o}`,{detail:{el:s,args:a}})),!0),r={onChange:(...o)=>n("change",t,...o),onItemAdd:(...o)=>n("item-add",t,...o),onItemRemove:(...o)=>n("item-remove",t,...o),onOptionAdd:(...o)=>n("option-add",t,...o),onOptionRemove:(...o)=>n("option-remove",t,...o),onDropdownOpen:(...o)=>n("open",t,...o),onDropdownClose:(...o)=>n("close",t,...o),onFocus:(...o)=>n("focus",t,...o),onBlur:(...o)=>n("blur",t,...o),onInitialize:(...o)=>n("initialize",t,...o),...e};if(t.dataset.action==="add-item"){let o=t.closest(".rs-util-settings-field-value"),s=o.querySelector(".rs-util-settings-sortable-list");i.makeSortable(s,{onSort:()=>{i.updateListValues(o)}}),r.onItemAdd=(a,...c)=>{let l=t.currentResults?.[a]??a;i.addListItem(o,a,l),t.tom.clear(),t.tom.blur()}}if(t.dataset.source){let o=JSON.parse(t.dataset.source),s=o.value.split("."),a=o.label.split(".");r.load=(c,l)=>{let u=o.url.replace("@query",encodeURIComponent(c));fetch(u).then(d=>d.json()).then(d=>{let h=[];t.currentResults??={},d.forEach(v=>{let f=v;s.forEach(I=>{f=f[I]});let m=v;a.forEach(I=>{m=m[I]}),h.push({value:f,label:m}),t.currentResults[f]=m}),l(h)}).catch(d=>console.error(d))},r.valueField="value",r.labelField="label",r.searchField="label"}t.tom=new xn(t,r)}static makeSortable(t,e={}){Qn.create(t,{animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",handle:".rs-util-settings-draggable-handle",...e})}static addListItem=(t,e,n)=>{let r=(t.querySelector('input[type="hidden"]').value?JSON.parse(t.querySelector('input[type="hidden"]').value):null)||[];r.push(e),t.querySelector('input[type="hidden"]').value=JSON.stringify(r);let o=document.createElement("div");o.classList.add("rs-util-settings-sortable-list-item"),o.dataset.value=e,o.innerHTML=`
			<span class="rs-util-settings-draggable-handle"></span>
			<span>${n}</span>
			<button type="button" class="rs-util-settings-trash-btn" data-action="remove-item">Remove Item</button>
		`,t.querySelector(".rs-util-settings-sortable-list").append(o),i.enableSaveButton()};static removeListItem=t=>{let e=t.closest(".rs-util-settings-field-value");t.remove(),i.updateListValues(e),i.enableSaveButton()};static updateListValues(t){let e=t.querySelector('input[type="hidden"]'),n=t.querySelector(".rs-util-settings-sortable-list"),r=[];n.querySelectorAll(".rs-util-settings-sortable-list-item").forEach(o=>{r.push(o.dataset.value)}),e.value=JSON.stringify(r),i.enableSaveButton()}static install(){new i}};window.rsUtil_SettingsPage=we;var ro=we;})();
/*! Bundled license information:

sortablejs/modular/sortable.esm.js:
  (**!
   * Sortable 1.15.6
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/
//# sourceMappingURL=rs-settings-page.min.js.map
